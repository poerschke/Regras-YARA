
import "pe"

rule familia3
{
    meta:
        author = "Douglas Poerschke Rocha"
        description = "malware familia 3 http://lpro/MAL/mal.php?mal=11"

    strings:
	$s1 = "xmlpz"
	$s2 = "909B916C908B81888183"
	$s3 = "7EBA49DC36D04E031E4EEBA761A67E97CF59D282B956D225F6A4F00D41D43EC856D73CE72DFF020611"
	$s4 = "73CF54D731DF3D30FD6E9B69A7AB8E898F9A97C751B846D44AC45EA660BE49D6"
	$s5 = "789A9661B25006061207"
	$s6 = "A79391948D78A5A874E422FF1854D832E526F869B65EBD5CB15CC55EAF6E9885"
	$s7 = "476572656E636961646F722064652054617265666173"
	$s8 = "4D656E7520496E6963696172"
	$s9 = "416C7465726EE26E6369612064652054617265666173"
	$s10 = "476572656E636961646F72206465205461726566617320646F2057696E646F7773"
	$s11 = "4672616D6520546162"
	$s12 = "49454672616D65"
	$s13 = "696578706C6F72652E657865"
	$s14 = "66697265666F782E657865"
	$s15 = "6368726F6D652E657865"
	$s16 = "77696E36342E747874"
	$s17 = "77696E36342E747874"
	$s18 = "686F6F6B6D67722E737973"
	$s19 = "hookmgr.sys"
	$s20 = "4C4942483332"
	$s21 = "LIBH32"
	$s22 = "6D65676173746F72652E657865"
	$s23 = "megastore.exe"
	$s24 = "686F6F6B6D677236342E737973"
	$s25 = "hookmgr64.sys"
	$s26 = "4C49423634"
	$s27 = "LIB64"
	$s28 = "49544E4153434E"
	$s29 = "ITNASCN"
	$s30 = "54454C495455"
	$s31 = "TELITU"
	$s32 = "49544E41534355"
	$s33 = "ITNASCU"
	$s34 = "54454C495450"
	$s35 = "TELITP"
	$s36 = "49544E41534350"
	$s37 = "ITNASCP"
	$s38 = "544142454C36554E49"
	$s39 = "TABEL6UNI"
	$s40 = "544142454C36504552"
	$s41 = "TABEL6PER"
	$s42 = "53454E4841364954"
	$s43 = "SENHA6IT"
	$s44 = "53454E484136554E"
	$s45 = "SENHA6UN"
	$s46 = "53454E4841365045"
	$s47 = "SENHA6PE"
	$s48 = "544F4B454E4954"
	$s49 = "TOKENIT"
	$s50 = "544F4B454E4E4153434E"
	$s51 = "TOKENNASCN"
	$s52 = "544F4B454E415050"
	$s53 = "TOKENAPP"
	$s54 = "544F4B454E4E41534355"
	$s55 = "TOKENNASCU"
	$s56 = "544F4B454E554E49"
	$s57 = "TOKENUNI"
	$s58 = "544F4B454E415050554E49"
	$s59 = "TOKENAPPUNI"
	$s60 = "544F4B454E4E41534350"
	$s61 = "TOKENNASCP"
	$s62 = "544F4B454E5045"
	$s63 = "TOKENPE"
	$s64 = "544F4B454E4150505045"
	$s65 = "TOKENAPPPE"
	$s66 = "534D534954"
	$s67 = "SMSIT"
	$s68 = "534D534954"
	$s69 = "SMSIT"
	$s70 = "534D534954"
	$s71 = "SMSIT"
	$s72 = "435656495453"
	$s73 = "CVVITS"
	$s74 = "435656495455"
	$s75 = "CVVITU"
	$s76 = "435656495450"
	$s77 = "CVVITP"
	$s78 = "53454E4841364346"
	$s79 = "SENHA6CF"
	$s80 = "53454E484136414C4641"
	$s81 = "SENHA6ALFA"
	$s82 = "5452415641434546"
	$s83 = "TRAVACEF"
	$s84 = "544F4B454E534943"
	$s85 = "TOKENSIC"
	$s86 = "5452415641534943"
	$s87 = "TRAVASIC"
	$s88 = "534943415353"
	$s89 = "SICASS"
	$s90 = "53454E4841365341"
	$s91 = "SENHA6SA"
	$s92 = "544F4B454E5345"
	$s93 = "TOKENSE"
	$s94 = "544F4B454E5341"
	$s95 = "TOKENSA"
	$s96 = "53454E48414D5341"
	$s97 = "SENHAMSA"
	$s98 = "444553434F42"
	$s99 = "DESCOB"
	$s100 = "444553434F50"
	$s101 = "DESCOP"
	$s102 = "444553434F544F"
	$s103 = "DESCOTO"
	$s104 = "444553434F345052494D45"
	$s105 = "DESCO4PRIME"
	$s106 = "444553434F434350"
	$s107 = "DESCOCCP"
	$s108 = "444553434F43434E"
	$s109 = "DESCOCCN"
	$s110 = "444553434F34"
	$s111 = "DESCO4"
	$s112 = "444553434F504F"
	$s113 = "DESCOPO"
	$s114 = "444553434F5345"
	$s115 = "DESCOSE"
	$s116 = "444553434F54"
	$s117 = "DESCOT"
	$s118 = "444553434F534E"
	$s119 = "DESCOSN"
	$s120 = "444553434F5450"
	$s121 = "DESCOTP"
	$s122 = "444553434F5452414E"
	$s123 = "DESCOTRAN"
	$s124 = "54524156414242"
	$s125 = "TRAVABB"
	$s126 = "545241564153414E"
	$s127 = "TRAVASAN"
	$s128 = "4242474641"
	$s129 = "BBGFA"
	$s130 = "4242474643"
	$s131 = "BBGFC"
	$s132 = "4242474638"
	$s133 = "BBGF8"
	$s134 = "54524156414E4F"
	$s135 = "TRAVANO"
	$s136 = "5452415641554E49"
	$s137 = "TRAVAUNI"
	$s138 = "5452415641504552"
	$s139 = "TRAVAPER"
	$s140 = "444553434F4E4554"
	$s141 = "DESCONET"
	$s142 = "444553434F4E455443"
	$s143 = "DESCONETC"
	$s144 = "444553434F434F44454E"
	$s145 = "DESCOCODEN"
	$s146 = "444553434F4E455454"
	$s147 = "DESCONETT"
	$s148 = "444553434F4E4554534D53"
	$s149 = "DESCONETSMS"
	$s150 = "5452415641454D"
	$s151 = "TRAVAEM"
	$s152 = "544F4B454E454D"
	$s153 = "TOKENEM"
	$s154 = "544F4B454E415050454D"
	$s155 = "TOKENAPPEM"
	$s156 = "534D53454D"
	$s157 = "SMSEM"
	$s158 = "5452415641424245"
	$s159 = "TRAVABBE"
	$s160 = "53454E48413645"
	$s161 = "SENHA6E"
	$s162 = "53454E48413845"
	$s163 = "SENHA8E"
	$s164 = "424245534D5345"
	$s165 = "BBESMSE"
	$s166 = "5452415641424253"
	$s167 = "TRAVABBS"
	$s168 = "424245435358"
	$s169 = "BBECSX"
	$s170 = "424258435331"
	$s171 = "BBXCS1"
	$s172 = "54524156415349434F4F42"
	$s173 = "TRAVASICOOB"
	$s174 = "434F42415353"
	$s175 = "COBASS"
	$s176 = "434F42544142"
	$s177 = "COBTAB"
	$s178 = "434F42454645"
	$s179 = "COBEFE"
	$s180 = "434F42345345"
	$s181 = "COB4SE"
	$s182 = "545241564153414E46"
	$s183 = "TRAVASANF"
	$s184 = "53414E544146415353"
	$s185 = "SANTAFASS"
	$s186 = "53414E544146544F4B"
	$s187 = "SANTAFTOK"
	$s188 = "53414E544146415454"
	$s189 = "SANTAFATT"
	$s190 = "53414E544146544142"
	$s191 = "SANTAFTAB"
	$s192 = "53414E544146544F4B454E31"
	$s193 = "SANTAFTOKEN1"
	$s194 = "53414E5441465345524945"
	$s195 = "SANTAFSERIE"
	$s196 = "53414E5441534552494554"
	$s197 = "SANTASERIET"
	$s198 = "545241564153414E56"
	$s199 = "TRAVASANV"
	$s200 = "53414E544156415353"
	$s201 = "SANTAVASS"
	$s202 = "53414E544156544F4B454E31"
	$s203 = "SANTAVTOKEN1"
	$s204 = "53414E544156544F4B"
	$s205 = "SANTAVTOK"
	$s206 = "53414E544156544142"
	$s207 = "SANTAVTAB"
	$s208 = "53414E5441565345524945"
	$s209 = "SANTAVSERIE"
	$s210 = "545241564142414E5249"
	$s211 = "TRAVABANRI"
	$s212 = "53454E484142414E5249"
	$s213 = "SENHABANRI"
	$s214 = "54524156414853505245"
	$s215 = "TRAVAHSPRE"
	$s216 = "54524156414853"
	$s217 = "TRAVAHS"
	$s218 = "545241564148534E4F52"
	$s219 = "TRAVAHSNOR"
	$s220 = "544F4B454E50494E"
	$s221 = "TOKENPIN"
	$s222 = "53454E48413748534E"
	$s223 = "SENHA7HSN"
	$s224 = "53454E4841374853"
	$s225 = "SENHA7HS"
	$s226 = "53454E4841374853505245"
	$s227 = "SENHA7HSPRE"
	$s228 = "53454E48413448534E"
	$s229 = "SENHA4HSN"
	$s230 = "53454E4841344853"
	$s231 = "SENHA4HS"
	$s232 = "53454E4841344853505245"
	$s233 = "SENHA4HSPRE"
	$s234 = "544F4B454E48534E"
	$s235 = "TOKENHSN"
	$s236 = "544F4B454E4853"
	$s237 = "TOKENHS"
	$s238 = "544F4B454E4853505245"
	$s239 = "TOKENHSPRE"
	$s240 = "56494148534E"
	$s241 = "VIAHSN"
	$s242 = "5649414853"
	$s243 = "VIAHS"
	$s244 = "5649414853505245"
	$s245 = "VIAHSPRE"
	$s246 = "545241564143495449"
	$s247 = "TRAVACITI"
	$s248 = "43495449434F4449474F"
	$s249 = "CITICODIGO"
	$s250 = "424C4F51444553434F"
	$s251 = "BLOQDESCO"
	$s252 = "424C4F51434546"
	$s253 = "BLOQCEF"
	$s254 = "424C4F51495441"
	$s255 = "BLOQITA"
	$s256 = "424C4F5153494352454449"
	$s257 = "BLOQSICREDI"
	$s258 = "424C4F515349434F4F42"
	$s259 = "BLOQSICOOB"
	$s260 = "424C4F514242"
	$s261 = "BLOQBB"
	$s262 = "424C4F5153414E5441"
	$s263 = "BLOQSANTA"
	$s264 = "424C4F5142414E524953554C"
	$s265 = "BLOQBANRISUL"
	$s266 = "424C4F5148534243"
	$s267 = "BLOQHSBC"
	$s268 = "424C4F5143495449"
	$s269 = "BLOQCITI"
	$s270 = "4465736B746F70"
	$s272 = "4465736B746F7032"
	$s273 = "Desktop2"
	$s274 = "3C7C676574737C3E"
	$s275 = "<|gets|>"
	$s276 = "3C7C6F6B6F6B7C3E"
	$s277 = "<|okok|>"
	$s278 = "3C7C66697273747C3E"
	$s279 = "<|first|>"
	$s280 = "3C7C6465736B697C3E"
	$s281 = "<|deski|>"
	$s282 = "4465736B746F70"
	$s284 = "3C7C6465736B69327C3E"
	$s285 = "<|deski2|>"
	$s286 = "4465736B746F7032"
	$s287 = "Desktop2"
	$s288 = "3C7C4465736B746F707C3E"
	$s289 = "<|Desktop|>"

    condition:
        5 of ($s*)
}
